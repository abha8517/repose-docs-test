<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>8.6.1.1 | Recipes | Vagrant</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="/_stylesheets/asciibinder.css" >
  <link rel="stylesheet" href="/_stylesheets/repose.css" >

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body onload="selectVersion('8.6.1.1');">
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a class="navbar-brand" href="http://www.openrepose.org/">
          <img alt="OpenRepose" src="/_images/repose-logo.png" align="bottom">
        </a>
      </li>
      <li class="sitename">
        <a href="../../index.html">
          Home
        </a>
      </li>
      <li class="hidden-xs active">
        <a href="/versions/8.6.1.1/welcome/index.html">
          Repose
        </a>
        <select id="version-selector" onchange="versionSelector(this);" w3-include-html="/_includes/versions.html">
        </select>
      </li>
      <li class="hidden-xs active">
        <a href="../recipes/index.html">Recipes</a>
      </li>
      
      <li class="hidden-xs active">
        Vagrant
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <a class="navbar-search" href="/versions/search.html">
          <span class="glyphicon glyphicon-search"/>
          Search
        </a>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-right"></span>Welcome to Repose
      </a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../welcome/index.html">Welcome</a></li>
            <li><a class="" href="../welcome/troubleshooting.html">Troubleshooting</a></li>
            <li><a class="" href="../welcome/release-notes.html">Release Notes</a></li>
            <li><a class="" href="../welcome/style-guide.html">Style Guide</a></li>
            <li><a class="" href="../welcome/faq.html">FAQ</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>Architecture
      </a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../architecture/index.html">Overview</a></li>
            <li><a class="" href="../architecture/configuration.html">Configuration</a></li>
            <li><a class="" href="../architecture/container.html">Container</a></li>
            <li><a class="" href="../architecture/packages.html">Packages</a></li>
            <li><a class="" href="../architecture/system-model.html">System Model</a></li>
            <li><a class="" href="../architecture/performance.html">Performance</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-down"></span>Recipes
      </a>
      <ul id="topicGroup2" class="collapse in list-unstyled">
            <li><a class="" href="../recipes/index.html">Overview</a></li>
            <li><a class="" href="../recipes/quick-setup.html">Quick Setup</a></li>
            <li><a class="" href="../recipes/getting-started.html">Getting Started</a></li>
            <li><a class="" href="../recipes/custom-filter-for-repose.html">Custom Filter for Repose</a></li>
            <li><a class="" href="../recipes/docker.html">Docker</a></li>
            <li><a class="" href="../recipes/performance-best-practices.html">Performance Best Practices</a></li>
            <li><a class="" href="../recipes/role-based-access-control.html">Role Based Access Control</a></li>
            <li><a class="" href="../recipes/running-valve.html">Running Valve</a></li>
            <li><a class=" active" href="../recipes/vagrant.html">Vagrant</a></li>
            <li><a class="" href="../recipes/valve-installation.html">Valve Installation</a></li>
            <li><a class="" href="../recipes/war-installation.html">WAR Installation</a></li>
            <li><a class="" href="../recipes/echo-server.html">Echo Server</a></li>
            <li><a class="" href="../recipes/rate-limiting.html">Rate Limiting</a></li>
            <li><a class="" href="../recipes/user-access-events.html">User Access Events</a></li>
            <li><a class="" href="../recipes/basic-authentication.html">Basic Authentication</a></li>
            <li><a class="" href="../recipes/distributed-rate-limiting.html">Distributed Rate Limiting</a></li>
            <li><a class="" href="../recipes/delegation.html">Delegation</a></li>
            <li><a class="" href="../recipes/preventing-xml-bomb.html">Preventing XML bomb attacks</a></li>
            <li><a class="" href="../recipes/api-event-flume.html">API Access Event Recording with Flume</a></li>
            <li><a class="" href="../recipes/xsd-versioning.html">XSD Versioning Guidelines</a></li>
            <li><a class="" href="../recipes/client-authentication.html">SSL/TLS Client Authentication</a></li>
            <li><a class="" href="../recipes/functional-test-framework.html">Functional Test Framework</a></li>
            <li><a class="" href="../recipes/glassfish-setup.html">Glassfish Setup</a></li>
            <li><a class="" href="../recipes/tomcat-setup.html">Tomcat Setup</a></li>
            <li><a class="" href="../recipes/http-container-attributes.html">HTTP Container Attributes</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-right"></span>Filters
      </a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../filters/index.html">Overview</a></li>
            <li><a class="" href="../filters/add-header.html">Add Header Filter</a></li>
            <li><a class="" href="../filters/api-validator.html">API Validator Filter</a></li>
            <li><a class="" href="../filters/attribute-mapping-policy-validation.html">Attribute Mapping Policy Validation filter</a></li>
            <li><a class="" href="../filters/body-extractor-to-header.html">Body Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/body-patcher.html">Body Patcher Filter</a></li>
            <li><a class="" href="../filters/compression.html">Compression Filter</a></li>
            <li><a class="" href="../filters/content-type-stripper.html">Content Type Stripper Filter</a></li>
            <li><a class="" href="../filters/cors.html">CORS Filter</a></li>
            <li><a class="" href="../filters/derp.html">Delegation Response Processor (DeRP) Filter</a></li>
            <li><a class="" href="../filters/destination-router.html">Destination Router Filter</a></li>
            <li><a class="" href="../filters/echo.html">Echo Filter</a></li>
            <li><a class="" href="../filters/exception.html">Exception Filter</a></li>
            <li><a class="" href="../filters/forwarded-proto.html">Forwarded Protocol Filter</a></li>
            <li><a class="" href="../filters/header-normalization.html">Header Normalization filter</a></li>
            <li><a class="" href="../filters/header-translation.html">Header Translation Filter</a></li>
            <li><a class="" href="../filters/header-user.html">Header User Filter</a></li>
            <li><a class="" href="../filters/herp.html">Highly Efficient Record Processor (HERP) Filter</a></li>
            <li><a class="" href="../filters/ip-user.html">IP User Filter</a></li>
            <li><a class="" href="../filters/iri-validator.html">IRI Validator Filter</a></li>
            <li><a class="" href="../filters/keystone-v2.html">Keystone v2 Filter</a></li>
            <li><a class="" href="../filters/keystone-v2-basic-auth.html">Keystone v2 Basic Auth Filter</a></li>
            <li><a class="" href="../filters/merge-header.html">Merge Header Filter</a></li>
            <li><a class="" href="../filters/openstack-identity-v3.html">Openstack Identity v3 Filter</a></li>
            <li><a class="" href="../filters/rackspace-auth-user.html">Rackspace Auth User Filter</a></li>
            <li><a class="" href="../filters/rate-limiting.html">Rate Limiting Filter</a></li>
            <li><a class="" href="../filters/saml-policy.html">SAML Policy Translation Filter</a></li>
            <li><a class="" href="../filters/scripting.html">Scripting Filter</a></li>
            <li><a class="" href="../filters/simple-rbac.html">Simple Role Based Access Control (RBAC) Filter</a></li>
            <li><a class="" href="../filters/slf4j-http-logging.html">SFL4J HTTP Logging Filter</a></li>
            <li><a class="" href="../filters/translation.html">Translation Filter</a></li>
            <li><a class="" href="../filters/uri-normalization.html">URI Normalization Filter</a></li>
            <li><a class="" href="../filters/uri-stripper.html">URI Stripper Filter</a></li>
            <li><a class="" href="../filters/uri-user.html">URI User Filter</a></li>
            <li><a class="" href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/valkyrie-authorization.html">Valkyrie Authorization Filter</a></li>
            <li><a class="" href="../filters/versioning.html">Versioning Filter</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-right"></span>Services
      </a>
      <ul id="topicGroup4" class="collapse  list-unstyled">
            <li><a class="" href="../services/index.html">Overview</a></li>
            <li><a class="" href="../services/atom-feed-consumption.html">Atom Feed Consumption Service</a></li>
            <li><a class="" href="../services/datastores.html">Datastores</a></li>
            <li><a class="" href="../services/health-check.html">Health Check service</a></li>
            <li><a class="" href="../services/http-connection-pool.html">HTTP Connection Pool service</a></li>
            <li><a class="" href="../services/metrics.html">Metrics Service</a></li>
            <li><a class="" href="../services/phone-home.html">Phone Home Service</a></li>
            <li><a class="" href="../services/response-messaging.html">Response Messaging service</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Vagrant</h2>
        </div>
        <div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you need a quick Linux environment setup to test or evaluate Repose, <a href="https://www.vagrantup.com/">Vagrant</a> makes it easy to create a new virtual machine with the <a href="https://atlas.hashicorp.com/boxes/search">Linux distribution of your choice</a> installed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a>Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="virtualbox"><a class="anchor" href="#virtualbox"></a>VirtualBox</h3>
<div class="paragraph">
<p>Vagrant needs a virtual machine provider such as VirtualBox.
<a href="https://www.virtualbox.org/">VirtualBox</a> can be installed on a variety of operating systems.
Check out the <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox Downloads</a> page and install the binary for your operating system.</p>
</div>
</div>
<div class="sect2">
<h3 id="vagrant"><a class="anchor" href="#vagrant"></a>Vagrant</h3>
<div class="paragraph">
<p>Check out the <a href="https://www.vagrantup.com/downloads.html">Vagrant Downloads</a> page and install the package for your operating system.</p>
</div>
</div>
<div class="sect2">
<h3 id="vagrant-plugins"><a class="anchor" href="#vagrant-plugins"></a>Vagrant Plugins</h3>
<div class="paragraph">
<p>It is extremely useful to install the Vagrant plugin for the VirtualBox Guest Additions.
To do so, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">vagrant plugin install vagrant-vbguest</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="which-way-build-environment-or-manual"><a class="anchor" href="#which-way-build-environment-or-manual"></a>Which way? Build Environment OR Manual?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From here you can either install a few more tools and use the automated build environment that the Repose team uses to verify a release, or you can manually set up your environment.</p>
</div>
<div class="sect2">
<h3 id="build-environment"><a class="anchor" href="#build-environment"></a>Build Environment</h3>
<div class="sect3">
<h4 id="install-git"><a class="anchor" href="#install-git"></a>Install Git</h4>
<div class="paragraph">
<p>Check out the <a href="https://git-scm.com/downloads">Git Downloads</a> page and install the package for your operating system.</p>
</div>
</div>
<div class="sect3">
<h4 id="run-the-sandbox"><a class="anchor" href="#run-the-sandbox"></a>Run the Sandbox</h4>
<div class="paragraph">
<p>To start the Vagrant sandbox using the build environment, you will need to clone the repository and then run execute build task with the desired properties.
Once the sandbox is running, the environment can be accessed directly by running the <code>vagrant ssh</code> command from the directory containing the Vagrantfile.</p>
</div>
<div class="listingblock">
<div class="title">Sandbox Instantiation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">git clone https://github.com/rackerlabs/repose.git
export REPOSE_HOME=$(pwd)/repose
cd ${REPOSE_HOME}
gradlew :repose-aggregator:tests:release-verification:vagrantUp[Deb|Rpm]
cd ${REPOSE_HOME}/repose-aggregator/tests/release-verification/src/vagrant/[deb|rpm]
vagrant ssh</code></pre>
</div>
</div>
<div class="paragraph">
<p>To access the Repose instance from the guest, simply send a request to the configured port of 8080.</p>
</div>
<div class="paragraph">
<p>The Vagrant guest VM&#8217;s also attempt to expose ports for both the Repose instance and Java Debug Wire Protocol (JDWP).
For Debian/Apt VM&#8217;s these are 18088 &amp; 18038 respectively and for RHEL/RPM VM&#8217;s 18089 &amp; 18039.
To access the Repose instance from the host simply send a request to the exposed port.
Similarly, to debug the Repose instance, connect a remote debugger to the JDWP port.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="manual"><a class="anchor" href="#manual"></a>Manual</h3>
<div class="sect3">
<h4 id="vm-setup"><a class="anchor" href="#vm-setup"></a>VM Setup</h4>
<div class="paragraph">
<p>Now you&#8217;re ready to use Vagrant to create a new virtual machine instance with a Linux distro installed.
Repose has been tested on Ubuntu and CentOS.
Setup instructions are provided for both.
For additional information on Vagrant commands, check out the Vagrant Docs for the <a href="https://docs.vagrantup.com/v2/cli/index.html">Command-Line Interface</a>.</p>
</div>
<div class="listingblock">
<div class="title">Debian</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"># create a new directory to hold some of your VM files
mkdir repose-vm
cd repose-vm

# create a new virtual machine and start it (VM will be downloaded if first time)
vagrant init ubuntu/xenial64; vagrant up --provider virtualbox

# ssh into your new virtual machine
vagrant ssh</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">CentOS</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"># create a new directory to hold some of your VM files
mkdir repose-vm
cd repose-vm

# create a new virtual machine and start it (VM will be downloaded if first time)
vagrant init centos/7; vagrant up --provider virtualbox

# ssh into your new virtual machine
vagrant ssh</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="clean-up"><a class="anchor" href="#clean-up"></a>Clean Up</h3>
<div class="paragraph">
<p>When you&#8217;re done with your virtual machine instance, use these instructions to clean up your resources.</p>
</div>
<div class="sect3">
<h4 id="saving-your-work"><a class="anchor" href="#saving-your-work"></a>Saving your work</h4>
<div class="paragraph">
<p>If you want to save any config files you created or the Repose logs, you can copy them to the <code>/vagrant</code> directory which for most instances is a shared mount between the Guest VM and Host OS where the Vagrantfile is located.
In the manual example above, it would be the <code>repose-vm</code> directory.</p>
</div>
<div class="listingblock">
<div class="title">Inside of your VM:</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"># copy your system model config to the shared directory
sudo cp /etc/repose/system-model.cfg.xml /vagrant

# here you should copy any other relevant configs as well

# copy your log files
sudo cp /var/log/repose/current.log /vagrant

# shutdown the box
sudo shutdown -h 0</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="delete-vm-instance"><a class="anchor" href="#delete-vm-instance"></a>Delete VM instance</h4>
<div class="listingblock">
<div class="title">Outside of your VM (i.e. in your host OS):</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"># make sure you're in the same directory as the Vagrant file
cd ${REPOSE_HOME}/repose-aggregator/tests/release-verification/src/vagrant/[deb|rpm]
# OR
cd repose-vm

# destroy the virtual machine (freeing up disk space)
vagrant destroy -f

# IF you manually created the Vagrantfile using vagrant init,
# THEN remove it as well.
rm -f Vagrantfile</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="/_javascripts/include-html.js" type="text/javascript"></script>
  <script>includeHTML();</script>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>