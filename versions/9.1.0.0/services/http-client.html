<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>9.1.0.0 | Services | HTTP Client Service</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="/_stylesheets/asciibinder.css" >
  <link rel="stylesheet" href="/_stylesheets/repose.css" >
  <link rel="stylesheet" href="/_stylesheets/release-note-categories.css" >

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body onload="selectVersion('9.1.0.0');">
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a class="navbar-brand" href="http://www.openrepose.org/">
          <img alt="OpenRepose" src="/_images/repose-logo.png" align="bottom">
        </a>
      </li>
      <li class="sitename">
        <a href="../../index.html">
          Home
        </a>
      </li>
      <li class="hidden-xs active">
        <a href="/versions/9.1.0.0/welcome/index.html">
          Repose
        </a>
        <select id="version-selector" onchange="versionSelector(this);" w3-include-html="/_includes/versions.html">
        </select>
      </li>
      <li class="hidden-xs active">
        <a href="../services/index.html">Services</a>
      </li>
      
      <li class="hidden-xs active">
        HTTP Client Service
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <a class="navbar-search" href="/versions/search.html">
          <span class="glyphicon glyphicon-search"/>
          Search
        </a>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-right"></span>Welcome to Repose
      </a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../welcome/index.html">Welcome</a></li>
            <li><a class="" href="../welcome/troubleshooting.html">Troubleshooting</a></li>
            <li><a class="" href="../welcome/release-notes.html">Release Notes</a></li>
            <li><a class="" href="../welcome/ver-9-upgrade-notes.html">Version 9 Upgrade Notes</a></li>
            <li><a class="" href="../welcome/style-guide.html">Style Guide</a></li>
            <li><a class="" href="../welcome/faq.html">FAQ</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>Architecture
      </a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../architecture/index.html">Overview</a></li>
            <li><a class="" href="../architecture/configuration.html">Configuration</a></li>
            <li><a class="" href="../architecture/container.html">Container</a></li>
            <li><a class="" href="../architecture/filter-chain.html">Filter Chain</a></li>
            <li><a class="" href="../architecture/logging.html">Logging</a></li>
            <li><a class="" href="../architecture/packages.html">Packages</a></li>
            <li><a class="" href="../architecture/servlet-spec.html">Servlet Specification</a></li>
            <li><a class="" href="../architecture/system-model.html">System Model</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-right"></span>Recipes
      </a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../recipes/index.html">Overview</a></li>
            <li><a class="" href="../recipes/quick-start.html">Quick Start</a></li>
            <li><a class="" href="../recipes/getting-started.html">Getting Started</a></li>
            <li><a class="" href="../recipes/custom-filter-for-repose.html">Custom Filter for Repose</a></li>
            <li><a class="" href="../recipes/docker.html">Docker</a></li>
            <li><a class="" href="../recipes/performance-best-practices.html">Performance Best Practices</a></li>
            <li><a class="" href="../recipes/role-based-access-control.html">Role Based Access Control</a></li>
            <li><a class="" href="../recipes/running-valve.html">Running Valve</a></li>
            <li><a class="" href="../recipes/valve-installation.html">Valve Installation</a></li>
            <li><a class="" href="../recipes/echo-server.html">Echo Server</a></li>
            <li><a class="" href="../recipes/rate-limiting.html">Rate Limiting</a></li>
            <li><a class="" href="../recipes/multi-tenant.html">Multi Tenant Authorization</a></li>
            <li><a class="" href="../recipes/user-access-events.html">User Access Events</a></li>
            <li><a class="" href="../recipes/basic-authentication.html">Basic Authentication</a></li>
            <li><a class="" href="../recipes/delegation.html">Delegation</a></li>
            <li><a class="" href="../recipes/preventing-xml-bomb.html">Preventing XML bomb attacks</a></li>
            <li><a class="" href="../recipes/api-event-flume.html">API Access Event Recording with Flume</a></li>
            <li><a class="" href="../recipes/xsd-versioning.html">XSD Versioning Guidelines</a></li>
            <li><a class="" href="../recipes/client-authentication.html">SSL/TLS Client Authentication</a></li>
            <li><a class="" href="../recipes/functional-test-framework.html">Functional Test Framework</a></li>
            <li><a class="" href="../recipes/header-splitting.html">Header Splitting</a></li>
            <li><a class="" href="../recipes/reason-phrase-normalization.html">Reason Phrase Normalization</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-right"></span>Filters
      </a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../filters/index.html">Overview</a></li>
            <li><a class="" href="../filters/add-header.html">Add Header Filter</a></li>
            <li><a class="" href="../filters/api-validator.html">API Validator Filter</a></li>
            <li><a class="" href="../filters/body-extractor-to-header.html">Body Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/body-patcher.html">Body Patcher Filter</a></li>
            <li><a class="" href="../filters/compression.html">Compression Filter</a></li>
            <li><a class="" href="../filters/content-type-stripper.html">Content Type Stripper Filter</a></li>
            <li><a class="" href="../filters/cors.html">CORS Filter</a></li>
            <li><a class="" href="../filters/derp.html">Delegation Response Processor (DeRP) Filter</a></li>
            <li><a class="" href="../filters/destination-router.html">Destination Router Filter</a></li>
            <li><a class="" href="../filters/echo.html">Echo Filter</a></li>
            <li><a class="" href="../filters/exception.html">Exception Filter</a></li>
            <li><a class="" href="../filters/forwarded-proto.html">Forwarded Protocol Filter</a></li>
            <li><a class="" href="../filters/header-normalization.html">Header Normalization filter</a></li>
            <li><a class="" href="../filters/header-translation.html">Header Translation Filter</a></li>
            <li><a class="" href="../filters/header-user.html">Header User Filter</a></li>
            <li><a class="" href="../filters/herp.html">Highly Efficient Record Processor (HERP) Filter</a></li>
            <li><a class="" href="../filters/ip-user.html">IP User Filter</a></li>
            <li><a class="" href="../filters/iri-validator.html">IRI Validator Filter</a></li>
            <li><a class="" href="../filters/keystone-v2.html">Keystone v2 Filter</a></li>
            <li><a class="" href="../filters/keystone-v2-authorization.html">Keystone v2 Authorization Filter</a></li>
            <li><a class="" href="../filters/keystone-v2-basic-auth.html">Keystone v2 Basic Auth Filter</a></li>
            <li><a class="" href="../filters/merge-header.html">Merge Header Filter</a></li>
            <li><a class="" href="../filters/openapi-validator.html">OpenAPI Validatort Filter</a></li>
            <li><a class="" href="../filters/openstack-identity-v3.html">Openstack Identity v3 Filter</a></li>
            <li><a class="" href="../filters/rate-limiting.html">Rate Limiting Filter</a></li>
            <li><a class="" href="../filters/regex-rbac.html">RegEx Role Based Access Control (RBAC) Filter</a></li>
            <li><a class="" href="../filters/scripting.html">Scripting Filter</a></li>
            <li><a class="" href="../filters/simple-rbac.html">Simple Role Based Access Control (RBAC) Filter</a></li>
            <li><a class="" href="../filters/slf4j-http-logging.html">SFL4J HTTP Logging Filter</a></li>
            <li><a class="" href="../filters/split-header.html">Split Header Filter</a></li>
            <li><a class="" href="../filters/tenant-culling.html">Tenant Culling Filter</a></li>
            <li><a class="" href="../filters/translation.html">Translation Filter</a></li>
            <li><a class="" href="../filters/uri-normalization.html">URI Normalization Filter</a></li>
            <li><a class="" href="../filters/uri-stripper.html">URI Stripper Filter</a></li>
            <li><a class="" href="../filters/uri-user.html">URI User Filter</a></li>
            <li><a class="" href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/valkyrie-authorization.html">Valkyrie Authorization Filter</a></li>
            <li><a class="" href="../filters/versioning.html">Versioning Filter</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-down"></span>Services
      </a>
      <ul id="topicGroup4" class="collapse in list-unstyled">
            <li><a class="" href="../services/index.html">Overview</a></li>
            <li><a class="" href="../services/atom-feed-consumption.html">Atom Feed Consumption Service</a></li>
            <li><a class="" href="../services/datastores.html">Datastores</a></li>
            <li><a class="" href="../services/health-check.html">Health Check Service</a></li>
            <li><a class=" active" href="../services/http-client.html">HTTP Client Service</a></li>
            <li><a class="" href="../services/http-logging.html">HTTP Logging Service</a></li>
            <li><a class="" href="../services/logging.html">Logging Service</a></li>
            <li><a class="" href="../services/metrics.html">Metrics Service</a></li>
            <li><a class="" href="../services/open-tracing.html">OpenTracing Service</a></li>
            <li><a class="" href="../services/phone-home.html">Phone Home Service</a></li>
            <li><a class="" href="../services/uri-redaction.html">URI Redaction service</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup5">
        <span id="tgSpan5" class="fa fa-angle-right"></span>Developer
      </a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../developer/index.html">Overview</a></li>
            <li><a class="" href="../developer/docker.html">Docker</a></li>
            <li><a class="" href="../developer/performance.html">Performance Testing</a></li>
            <li><a class="" href="../developer/functional.html">Functional Testing</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>HTTP Client Service</h2>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The HTTP Client Service provides a centralized way of managing and reusing HTTP clients for outbound communication.</p>
</div>
<div class="paragraph">
<p>This service introduces the concept of named connection pools.
A named connection pool is described by a number of configuration options that dictate how a connection from that pool should behave.
Connections from a pool are reused to cut down on the overhead of connection negotiation when resources are frequently accessed.
The id/name of the pool corresponds to the connection pool id found in other services' and filters' configurations, indicating that outbound connections from that component should use the matching pool.</p>
</div>
<div class="paragraph">
<p>While named connection pools are the abstraction presented for configuration, HTTP clients are the abstraction presented for use in code.
In reality, an HTTP client manages a connection pool.
A developer leveraging this service will interact with the HTTP client abstraction.
An operator configuring this service will interact with the named connection pool abstraction.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Default Configuration:</strong> http-connection-pool.cfg.xml</p>
</li>
<li>
<p><strong>Released:</strong> v2.8.3</p>
</li>
<li>
<p><a href="../schemas/http-connection-pool.xsd">Schema</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="full-configuration"><a class="anchor" href="#full-configuration"></a>Full Configuration</h3>
<div class="listingblock">
<div class="title">http-connection-pool.cfg.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;http-connection-pools</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://docs.openrepose.org/repose/http-connection-pool/v1.0</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;pool</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">default</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
          <span style="color:#b48">default</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
          <span style="color:#b48">cache.ttl</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">500</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
          <span style="color:#b48">http.conn-manager.max-total</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">400</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
          <span style="color:#b48">http.conn-manager.max-per-route</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">200</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="5"></i><b>(5)</b>
          <span style="color:#b48">http.socket.timeout</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">30000</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="6"></i><b>(6)</b>
          <span style="color:#b48">http.socket.buffer-size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">8192</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="7"></i><b>(7)</b>
          <span style="color:#b48">http.connection.timeout</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">30000</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="8"></i><b>(8)</b>
          <span style="color:#b48">http.connection.max-line-length</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">8192</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="9"></i><b>(9)</b>
          <span style="color:#b48">http.connection.max-header-count</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">100</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="10"></i><b>(10)</b>
          <span style="color:#b48">http.tcp.nodelay</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="11"></i><b>(11)</b>
          <span style="color:#b48">http.route.default-proxy</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://example.com:80</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="12"></i><b>(12)</b>
          <span style="color:#b48">keepalive.timeout</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="13"></i><b>(13)</b>
          <span style="color:#b48">keystore-filename</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">client.jks</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="14"></i><b>(14)</b>
          <span style="color:#b48">keystore-password</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="15"></i><b>(15)</b>
          <span style="color:#b48">key-password</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="16"></i><b>(16)</b>
          <span style="color:#b48">truststore-filename</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">servers.jks</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="17"></i><b>(17)</b>
          <span style="color:#b48">truststore-password</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span> <i class="conum" data-value="18"></i><b>(18)</b>
        <span style="color:#070;font-weight:bold">&lt;headers&gt;</span> <i class="conum" data-value="19"></i><b>(19)</b>
            <span style="color:#070;font-weight:bold">&lt;header</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bar</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <i class="conum" data-value="20"></i><b>(20)</b>
        <span style="color:#070;font-weight:bold">&lt;/headers&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/pool&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;pool</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">banana</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <i class="conum" data-value="21"></i><b>(21)</b>
<span style="color:#070;font-weight:bold">&lt;/http-connection-pools&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The id/name of this pool, it must be unique.
Used to identify this pool for usage by other services/filters.
The only required attribute for a pool.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Whether or not this pool is the default pool for the connection service.
You must have exactly one pool marked as the default.
This pool is the one that will be used to make connections to the origin service.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Amount of time, in milliseconds, to cache the HTTP interaction (i.e., the sending of the request and receiving of the response).
While more than one request may be made to the HTTP client at the same time with the same cache key, only one request will be made by the HTTP client at a time per cache key.
In effect, this means the first request made to the HTTP client is cached until the HTTP client receives a response, at which point the response is cached (up to the defined TTL).
For example, if request A is made to the HTTP client 1 millisecond before request B and both requests have the same cache key, request A will be sent over the wire by the HTTP client, and both requester A and requester B will await the response for request A.
Both requester A and requester B will receive the same response once the response for request A is available.
If request C is made 250 milliseconds after request B (with the same cache key, within the defined TTL), requester C will immediately receive the response for request A.
This is the same response that requester A and requester B received.
If request D is made 501 milliseconds after request B (with the same cache key, not within the defined TTL), request D will be sent over the wire by the HTTP client, and requester D will receive a response different from the response received by requesters A, B, and C.<br>
Default: <code>500</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Maximum number of connections opened across all endpoints in this connection pool.
If this is set too high, you may run out of memory.<br>
Default: <code>400</code></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Maximum number of connections opened per endpoint in this connection pool.<br>
Default: <code>200</code></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Defines the socket timeout in milliseconds, which is the timeout for waiting for data (or, put differently, a maximum period of inactivity between two consecutive data packets).
A timeout value of zero is interpreted as an infinite timeout.<br>
Default: <code>30000</code></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Determines the size of the internal socket buffer used to buffer data while receiving / transmitting HTTP messages.<br>
Default: <code>8192</code></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Determines the timeout in milliseconds until a connection is established.
A timeout value of zero is interpreted as an infinite timeout.
Please note this parameter can only be applied to connections that are bound to a particular local address.<br>
Default: <code>30000</code></td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Determines the maximum line length limit.
If set to a positive value, any HTTP line exceeding this limit will cause an IOException.
A negative or zero value will effectively disable the check.<br>
Default: <code>8192</code></td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Determines the maximum HTTP header count allowed.
If set to a positive value, the number of HTTP headers received from the data stream exceeding this limit will cause an IOException.
A negative or zero value will effectively disable the check.<br>
Default: <code>100</code></td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Determines whether Nagle&#8217;s algorithm is to be used.
The Nagle&#8217;s algorithm tries to conserve bandwidth by minimizing the number of segments that are sent.
When applications wish to decrease network latency and increase performance, they can disable Nagle&#8217;s algorithm (that is enable http.tcp.nodelay).
Data will be sent earlier, at the cost of an increase in bandwidth consumption.<br>
Default: <code>true</code></td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Optionally defines a proxy host to be used.<br>
If present, requests made using this connection pool will be proxied through the provided proxy host.<br>
If absent, requests made using this connection pool will not be proxied.<br>
The value of this attribute should be in the form <code>{scheme}://{host}:{port}</code>.
Note that <code>{scheme}</code> and <code>{port}</code> are optional while <code>{host}</code> is required.
If no scheme is provided, <code>http</code> is assumed.
If no port is provided, <code>80</code> (the default port for <code>http</code>) is assumed.
The following are examples of acceptable values for this attribute:
<div class="ulist">
<ul>
<li>
<p><code><a href="http://example.com:80" class="bare">http://example.com:80</a></code></p>
</li>
<li>
<p><code><a href="http://example.com" class="bare">http://example.com</a></code></p>
</li>
<li>
<p><code>example.com:80</code></p>
</li>
<li>
<p><code>example.com</code></p>
</li>
</ul>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>If a Keep-Alive header is not present in the response, the value of keepalive.timeout is evaluated.
If this value is 0, the connection will be kept alive indefinitely.
If the value is greater than 0, the connection will be kept alive for the number of milliseconds specified.
Set to 1 to connect:close.<br>
Default: <code>0</code></td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>The keystore filename either fully qualified or relative to the <strong>Repose</strong> <a href="../architecture/configuration.html">configuration directory</a>.
Used for SSL/TLS Client Authentication.<br>
NOTE: The <code>keystore-filename</code>, <code>keystore-password</code>, and <code>key-password</code> are all mutually required.
If one exists, then they all must exist and client authentication is assumed to be required.</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>The password to access the keystore.<br>
NOTE: The <code>keystore-filename</code>, <code>keystore-password</code>, and <code>key-password</code> are all mutually required.
If one exists, then they all must exist and client authentication is assumed to be required.</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td>The password for the particular key within the keystore.<br>
NOTE: The <code>keystore-filename</code>, <code>keystore-password</code>, and <code>key-password</code> are all mutually required.
If one exists, then they all must exist and client authentication is assumed to be required.</td>
</tr>
<tr>
<td><i class="conum" data-value="17"></i><b>17</b></td>
<td>The truststore filename either fully qualified or relative to the <strong>Repose</strong> <a href="../architecture/configuration.html">configuration directory</a>.
Used when it is necessary to have the certificate of the requested resource&#8217;s server.<br>
NOTE: The <code>truststore-filename</code> and <code>truststore-password</code> are mutually required.
If one exists, then the other must exist.</td>
</tr>
<tr>
<td><i class="conum" data-value="18"></i><b>18</b></td>
<td>The password to access the truststore.<br>
NOTE: The <code>truststore-filename</code> and <code>truststore-password</code> are mutually required.
If one exists, then the other must exist.</td>
</tr>
<tr>
<td><i class="conum" data-value="19"></i><b>19</b></td>
<td>Indicates that the configured list of headers should be added to every outbound request on this connection pool.
Use is optional.</td>
</tr>
<tr>
<td><i class="conum" data-value="20"></i><b>20</b></td>
<td>A header to be added to every outbound request from this connection pool.
At least on is required when using the optional <code>headers</code> element.</td>
</tr>
<tr>
<td><i class="conum" data-value="21"></i><b>21</b></td>
<td>A second pool is defined here that uses all the defaults.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="common-use-casesproblems"><a class="anchor" href="#common-use-casesproblems"></a>Common Use Cases/Problems</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="need-higher-concurrency"><a class="anchor" href="#need-higher-concurrency"></a>Need higher concurrency</h3>
<div class="paragraph">
<p>If the connection pool is filling up, but more resources are available on the machine <strong>Repose</strong> is running on, the pool can be expanded to allow more concurrent connections.
This is most useful if wait times are high or requests are timing out.
The size of the pools can be increased by raising <code>http.conn-manager.max-total</code> and <code>http.conn-manager.max-per-route</code>.</p>
</div>
<div class="listingblock">
<div class="title">partial http-connection-pool.cfg</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;pool</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">default</span><span style="color:#710">&quot;</span></span>
      <span style="color:#b48">...</span> <i class="conum" data-value="1"></i><b>(1)</b>
      <span style="color:#b48">http.conn-manager.max-total</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">800</span><span style="color:#710">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
      <span style="color:#b48">http.conn-manager.max-per-route</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">300</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
<span style="color:#070;font-weight:bold">&lt;/pool&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The existing pool attributes.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The new overall pool size.
This is the maximum number of connections this pool will have open at once.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The new max number of connections to a single endpoint.
If a pool is only ever used for a single endpoint (e.g., foo.com), then this number and <code>http.conn-manager.max-total</code> should be the same.
If they aren&#8217;t then the max pool size will never be reached.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="requested-endpoint-requires-a-static-header"><a class="anchor" href="#requested-endpoint-requires-a-static-header"></a>Requested endpoint requires a static header</h3>
<div class="paragraph">
<p>Some services require a static header be present just for the purposes of identification; this can easily be done by adding the <code>headers</code> element to the pool configuration.</p>
</div>
<div class="listingblock">
<div class="title">http-connection-pool.cfg.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;http-connection-pools</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://docs.openrepose.org/repose/http-connection-pool/v1.0</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;pool</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">default</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;headers&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span style="color:#070;font-weight:bold">&lt;header</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bar</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span style="color:#070;font-weight:bold">&lt;/headers&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/pool&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/http-connection-pools&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The element to add to the pool configuration to trigger this behavior.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The header name and value to add to the outbound request.
Multiple <code>header</code> elements can be specified if more than one is desired.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="proxy-must-be-used"><a class="anchor" href="#proxy-must-be-used"></a>Proxy must be used</h3>
<div class="paragraph">
<p>In certain environments, it may be necessary to utilize a proxy for outbound requests.
For example, <strong>Repose</strong> running on a private network may not be allowed to make direct connections to resources outside of the network.
Instead, controlled connections can be made with a proxy which will forward requests to their intended destinations.</p>
</div>
<div class="paragraph">
<p>To configure the usage of a proxy, simply update the configuration for this service as done below.</p>
</div>
<div class="listingblock">
<div class="title">partial http-connection-pool.cfg.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;http-connection-pools</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://docs.openrepose.org/repose/http-connection-pool/v1.0</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;pool</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">default</span><span style="color:#710">&quot;</span></span>
          <span style="color:#b48">default</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span>
          <span style="color:#b48">http.route.default-proxy</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://example.com:80</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span style="color:#070;font-weight:bold">&lt;/http-connection-pools&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The proxy to be used.
For details on acceptable values for this attribute, see <a href="#full-configuration">Full Configuration</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ssltls-client-authentication"><a class="anchor" href="#ssltls-client-authentication"></a>SSL/TLS Client Authentication</h3>
<div class="paragraph">
<p>See <a href="../recipes/client-authentication.html">SSL/TLS Client Authentication</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="further-information"><a class="anchor" href="#further-information"></a>Further Information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For more information about the <code>http.*</code> attributes or the underlying connection pool see <a href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html">Apache Connection Management</a>.</p>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="/_javascripts/include-html.js" type="text/javascript"></script>
  <script>includeHTML();</script>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>