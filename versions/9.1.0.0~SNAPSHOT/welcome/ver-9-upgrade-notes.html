<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>9.1.0.0~SNAPSHOT | Welcome to Repose | Version 9 Upgrade Notes</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="/_stylesheets/asciibinder.css" >
  <link rel="stylesheet" href="/_stylesheets/repose.css" >
  <link rel="stylesheet" href="/_stylesheets/release-note-categories.css" >

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body onload="selectVersion('9.1.0.0~SNAPSHOT');">
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a class="navbar-brand" href="http://www.openrepose.org/">
          <img alt="OpenRepose" src="/_images/repose-logo.png" align="bottom">
        </a>
      </li>
      <li class="sitename">
        <a href="../../index.html">
          Home
        </a>
      </li>
      <li class="hidden-xs active">
        <a href="/versions/9.1.0.0~SNAPSHOT/welcome/index.html">
          Repose
        </a>
        <select id="version-selector" onchange="versionSelector(this);" w3-include-html="/_includes/versions.html">
        </select>
      </li>
      <li class="hidden-xs active">
        <a href="../welcome/index.html">Welcome to Repose</a>
      </li>
      
      <li class="hidden-xs active">
        Version 9 Upgrade Notes
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <a class="navbar-search" href="/versions/search.html">
          <span class="glyphicon glyphicon-search"/>
          Search
        </a>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Welcome to Repose
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../welcome/index.html">Welcome</a></li>
            <li><a class="" href="../welcome/troubleshooting.html">Troubleshooting</a></li>
            <li><a class="" href="../welcome/release-notes.html">Release Notes</a></li>
            <li><a class=" active" href="../welcome/ver-9-upgrade-notes.html">Version 9 Upgrade Notes</a></li>
            <li><a class="" href="../welcome/style-guide.html">Style Guide</a></li>
            <li><a class="" href="../welcome/faq.html">FAQ</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>Architecture
      </a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../architecture/index.html">Overview</a></li>
            <li><a class="" href="../architecture/configuration.html">Configuration</a></li>
            <li><a class="" href="../architecture/container.html">Container</a></li>
            <li><a class="" href="../architecture/filter-chain.html">Filter Chain</a></li>
            <li><a class="" href="../architecture/logging.html">Logging</a></li>
            <li><a class="" href="../architecture/packages.html">Packages</a></li>
            <li><a class="" href="../architecture/servlet-spec.html">Servlet Specification</a></li>
            <li><a class="" href="../architecture/system-model.html">System Model</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-right"></span>Recipes
      </a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../recipes/index.html">Overview</a></li>
            <li><a class="" href="../recipes/quick-start.html">Quick Start</a></li>
            <li><a class="" href="../recipes/getting-started.html">Getting Started</a></li>
            <li><a class="" href="../recipes/custom-filter-for-repose.html">Custom Filter for Repose</a></li>
            <li><a class="" href="../recipes/docker.html">Docker</a></li>
            <li><a class="" href="../recipes/performance-best-practices.html">Performance Best Practices</a></li>
            <li><a class="" href="../recipes/role-based-access-control.html">Role Based Access Control</a></li>
            <li><a class="" href="../recipes/running-valve.html">Running Valve</a></li>
            <li><a class="" href="../recipes/valve-installation.html">Valve Installation</a></li>
            <li><a class="" href="../recipes/echo-server.html">Echo Server</a></li>
            <li><a class="" href="../recipes/rate-limiting.html">Rate Limiting</a></li>
            <li><a class="" href="../recipes/multi-tenant.html">Multi Tenant Authorization</a></li>
            <li><a class="" href="../recipes/user-access-events.html">User Access Events</a></li>
            <li><a class="" href="../recipes/basic-authentication.html">Basic Authentication</a></li>
            <li><a class="" href="../recipes/delegation.html">Delegation</a></li>
            <li><a class="" href="../recipes/preventing-xml-bomb.html">Preventing XML bomb attacks</a></li>
            <li><a class="" href="../recipes/api-event-flume.html">API Access Event Recording with Flume</a></li>
            <li><a class="" href="../recipes/xsd-versioning.html">XSD Versioning Guidelines</a></li>
            <li><a class="" href="../recipes/client-authentication.html">SSL/TLS Client Authentication</a></li>
            <li><a class="" href="../recipes/functional-test-framework.html">Functional Test Framework</a></li>
            <li><a class="" href="../recipes/header-splitting.html">Header Splitting</a></li>
            <li><a class="" href="../recipes/reason-phrase-normalization.html">Reason Phrase Normalization</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-right"></span>Filters
      </a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../filters/index.html">Overview</a></li>
            <li><a class="" href="../filters/add-header.html">Add Header Filter</a></li>
            <li><a class="" href="../filters/api-validator.html">API Validator Filter</a></li>
            <li><a class="" href="../filters/body-extractor-to-header.html">Body Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/body-patcher.html">Body Patcher Filter</a></li>
            <li><a class="" href="../filters/compression.html">Compression Filter</a></li>
            <li><a class="" href="../filters/content-type-stripper.html">Content Type Stripper Filter</a></li>
            <li><a class="" href="../filters/cors.html">CORS Filter</a></li>
            <li><a class="" href="../filters/derp.html">Delegation Response Processor (DeRP) Filter</a></li>
            <li><a class="" href="../filters/destination-router.html">Destination Router Filter</a></li>
            <li><a class="" href="../filters/echo.html">Echo Filter</a></li>
            <li><a class="" href="../filters/exception.html">Exception Filter</a></li>
            <li><a class="" href="../filters/forwarded-proto.html">Forwarded Protocol Filter</a></li>
            <li><a class="" href="../filters/header-normalization.html">Header Normalization filter</a></li>
            <li><a class="" href="../filters/header-translation.html">Header Translation Filter</a></li>
            <li><a class="" href="../filters/header-user.html">Header User Filter</a></li>
            <li><a class="" href="../filters/herp.html">Highly Efficient Record Processor (HERP) Filter</a></li>
            <li><a class="" href="../filters/ip-user.html">IP User Filter</a></li>
            <li><a class="" href="../filters/iri-validator.html">IRI Validator Filter</a></li>
            <li><a class="" href="../filters/keystone-v2.html">Keystone v2 Filter</a></li>
            <li><a class="" href="../filters/keystone-v2-authorization.html">Keystone v2 Authorization Filter</a></li>
            <li><a class="" href="../filters/keystone-v2-basic-auth.html">Keystone v2 Basic Auth Filter</a></li>
            <li><a class="" href="../filters/merge-header.html">Merge Header Filter</a></li>
            <li><a class="" href="../filters/openapi-validator.html">OpenAPI Validatort Filter</a></li>
            <li><a class="" href="../filters/openstack-identity-v3.html">Openstack Identity v3 Filter</a></li>
            <li><a class="" href="../filters/rate-limiting.html">Rate Limiting Filter</a></li>
            <li><a class="" href="../filters/regex-rbac.html">RegEx Role Based Access Control (RBAC) Filter</a></li>
            <li><a class="" href="../filters/scripting.html">Scripting Filter</a></li>
            <li><a class="" href="../filters/simple-rbac.html">Simple Role Based Access Control (RBAC) Filter</a></li>
            <li><a class="" href="../filters/slf4j-http-logging.html">SFL4J HTTP Logging Filter</a></li>
            <li><a class="" href="../filters/split-header.html">Split Header Filter</a></li>
            <li><a class="" href="../filters/tenant-culling.html">Tenant Culling Filter</a></li>
            <li><a class="" href="../filters/translation.html">Translation Filter</a></li>
            <li><a class="" href="../filters/uri-normalization.html">URI Normalization Filter</a></li>
            <li><a class="" href="../filters/uri-stripper.html">URI Stripper Filter</a></li>
            <li><a class="" href="../filters/uri-user.html">URI User Filter</a></li>
            <li><a class="" href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/valkyrie-authorization.html">Valkyrie Authorization Filter</a></li>
            <li><a class="" href="../filters/versioning.html">Versioning Filter</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-right"></span>Services
      </a>
      <ul id="topicGroup4" class="collapse  list-unstyled">
            <li><a class="" href="../services/index.html">Overview</a></li>
            <li><a class="" href="../services/atom-feed-consumption.html">Atom Feed Consumption Service</a></li>
            <li><a class="" href="../services/datastores.html">Datastores</a></li>
            <li><a class="" href="../services/health-check.html">Health Check Service</a></li>
            <li><a class="" href="../services/http-client.html">HTTP Client Service</a></li>
            <li><a class="" href="../services/http-logging.html">HTTP Logging Service</a></li>
            <li><a class="" href="../services/logging.html">Logging Service</a></li>
            <li><a class="" href="../services/metrics.html">Metrics Service</a></li>
            <li><a class="" href="../services/open-tracing.html">OpenTracing Service</a></li>
            <li><a class="" href="../services/phone-home.html">Phone Home Service</a></li>
            <li><a class="" href="../services/uri-redaction.html">URI Redaction service</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup5">
        <span id="tgSpan5" class="fa fa-angle-right"></span>Developer
      </a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../developer/index.html">Overview</a></li>
            <li><a class="" href="../developer/docker.html">Docker</a></li>
            <li><a class="" href="../developer/performance.html">Performance Testing</a></li>
            <li><a class="" href="../developer/functional.html">Functional Testing</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Upgrade to Version 9 from Version 8 Notes</h2>
        </div>
        <div class="sect1">
<h2 id="core-behavior-changes"><a class="anchor" href="#core-behavior-changes"></a>Core Behavior Changes</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Headers will no longer be split unnecessarily at the boundaries of <strong>Repose</strong>.
If you were counting on this behavior, or for a list of headers that were being split, see <a href="../recipes/header-splitting.html">Pre 9.0 Header Splitting</a>.</p>
</li>
<li>
<p>Headers with an empty value will no longer be automatically removed from requests or responses.
If you were counting on this behavior, the <a href="../filters/scripting.html">Scripting Filter</a> can be used.
The scripting filter configuration may look like the following:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;script</span><span style="color:#b48">ing</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://docs.openrepose.org/repose/scripting/v1.0</span><span style="color:#710">&quot;</span></span>
         <span style="color:#b48">language</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">groovy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
<span style="background-color:hsla(0,0%,0%,0.07);color:black">  request.headerNames.each { headerName -&gt;
      <span style="color:#080;font-weight:bold">if</span> (!request.getHeader(headerName)) {
          request.removeHeader(headerName)
      }
  }
  filterChain.doFilter(request, response)
  response.headerNames.each { headerName -&gt;
      <span style="color:#080;font-weight:bold">if</span> (!response.getHeader(headerName)) {
          response.removeHeader(headerName)
      }
  }
&lt;<span style="background-color:hsla(300,100%,50%,0.06)"><span style="color:#404">/</span><span style="color:#808">scripting&gt;</span></span></span></code></pre>
</div>
</div>
</li>
<li>
<p>The response status line reason phrase from the origin service will now be forwarded from the origin service.
If you need <strong>Repose</strong> to normalize the reason phrase, see the <a href="../recipes/reason-phrase-normalization.html">Reason Phrase Normalization recipe</a>.</p>
</li>
<li>
<p>Requests can now contain headers with empty values.
For example, if <strong>Repose</strong> receives a request with the header line `My-Header: `, that header line will now be forwarded to the origin service.</p>
</li>
<li>
<p>Some core classes have been renamed.
If you need to customize the logging behavior for the loggers used by these classes, or if you rely on these classes directly, use the following mapping to update to the new class names:</p>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Old Class Name</th>
<th class="tableblock halign-left valign-top">New Class Name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.openrepose.powerfilter.PowerFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.openrepose.powerfilter.ReposeFilter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.openrepose.powerfilter.PowerFilterChain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.openrepose.powerfilter.ReposeFilterChain</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>The Response Messaging Service has been removed.
If you were counting on this behavior, the <a href="../filters/scripting.html">Scripting Filter</a> can be used.
The scripting filter configuration may look like the following:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span style="color:#070;font-weight:bold">&lt;script</span><span style="color:#b48">ing</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://docs.openrepose.org/repose/scripting/v1.0</span><span style="color:#710">&quot;</span></span>
           <span style="color:#b48">language</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">groovy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span><span style="background-color:hsla(0,0%,0%,0.07);color:black">&lt;![CDATA[
    <span style="color:#080;font-weight:bold">import</span> groovy.xml.MarkupBuilder

    <span style="color:#777">//Continue the filter chain</span>
    filterChain.doFilter(request, response)

    <span style="color:#777">//Check to see if we should monkey with the response because we have xml and a 2xx</span>
    <span style="color:#080;font-weight:bold">if</span>((response.contentType ==~ <span style="background-color:hsla(300,100%,50%,0.06)"><span style="color:#404">/</span><span style="color:#808">.*(xml|XML).*</span><span style="color:#404">/</span></span>) &amp;&amp; (response.status &gt;= <span style="color:#00D">400</span>) &amp;&amp; (response.status &lt; <span style="color:#00D">600</span>)) {

        <span style="color:#777">//Uncommit the response just in case</span>
        response.uncommit()

        <span style="color:#777">//Clear the current response body</span>
        response.resetBuffer()

        <span style="color:#777">//Write the new body</span>
        def xml = <span style="color:#080;font-weight:bold">new</span> MarkupBuilder(response.getWriter())
        xml.error() {
            status(response.getStatus())
            message(response.getReason())
        }
    }
]]&gt;&lt;<span style="background-color:hsla(300,100%,50%,0.06)"><span style="color:#404">/</span><span style="color:#808">scripting&gt;</span></span></span></code></pre>
</div>
</div>
</li>
<li>
<p>The <a href="../architecture/filter-chain.html">Filter Chain</a> now determines whether or not a filter should run based on the current state of the request rather than the state of the request when it was initially received.
If you are applying a condition to filter activation (e.g., using the <a href="../architecture/filter-chain.html#uri-regex">uri-regex attribute</a>) and you modify some part of the request (e.g., the URL) in one of your filters, you may be impacted by this change.
For more details, see <a href="../architecture/filter-chain.html#filter-activation-determination">filter activation determination</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="system-model-configuration"><a class="anchor" href="#system-model-configuration"></a>System Model Configuration</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Support for multi-cluster deployments has been removed.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>cluster</code> element was removed from the <a href="../architecture/system-model.html">system model</a>.
Remember that a cluster is just a logical grouping of nodes by their functionality, and as such, logical clusters can still be constructed outside of <strong>Repose</strong>.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>Repose</strong> clusters are no longer supported.
Instead, an operator will need to define <strong>Repose</strong> behavior per-node.
In other words, each <strong>Repose</strong> cluster will become a new <a href="../architecture/system-model.html">system model</a> configuration.
To route a request between <strong>Repose</strong> nodes, see the following bullet.</p>
</li>
<li>
<p>Service clusters (via round-robin routing) are no longer supported.
Instead, an operator may choose to use a router to route traffic between destinations with identical functionality.
A route could be anything from a physical F5 Load Balancer to a Cloud Load Balancer to an OpenShift service.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="container-configuration"><a class="anchor" href="#container-configuration"></a>Container Configuration</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>via</code> attribute was removed from the <a href="../architecture/container.html">container configuration</a>.
It has been replaced with the <code>via-header</code> element.
To replicate the previous behavior set the value that was previously in the <code>via</code> attribute in the <code>request-prefix</code> and <code>response-prefix</code> attributes of the new element.</p>
</li>
<li>
<p>The <code>soLingerTime</code> attribute was removed from the <a href="../architecture/container.html">container configuration</a>.
The underlying Jetty server no longer respects this value and therefore Repose will no longer expose it.
To replicate the previous behavior you need to configure it in the operating system.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deployment"><a class="anchor" href="#deployment"></a>Deployment</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Support for installing <strong>Repose</strong> into an existing container has been dropped. For help moving to another deployment see <a href="../recipes/valve-installation.html">Valve Installation</a> and <a href="../recipes/quick-start.html">Quick Start with Docker</a>.</p>
</li>
<li>
<p>The package for valve installation has changed from <code>repose-valve</code> to <code>repose</code>.</p>
</li>
<li>
<p>The <a href="../filters/scripting.html">Scripting Filter</a> has been moved from the <code>repose-experimental-filter-bundle</code> to the <code>repose-filter-bundle</code>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http-clientconnection-pool-service"><a class="anchor" href="#http-clientconnection-pool-service"></a>HTTP Client/Connection Pool Service</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If setting the <code>chunked-encoding</code> attribute, it will no longer be set in <a href="../services/http-client.html#configuration">HTTP Client Service configuration</a> but instead will be set in the <a href="../architecture/system-model.html#configuration">System Model configuration</a>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Deprecated configuration values have been removed; change <code>0</code> to <code>false</code> and <code>1</code> to <code>true</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The <code>http.connection.max-status-line-garbage</code> configuration attribute has been removed from the schema, and thus must be removed from configuration instances if present.
This attribute has never affected the processing performed by <strong>Repose</strong>, and so it should be safe to remove in all cases.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rackspace-auth-user-saml-policy-translation-and-attribute-mapping-policy-validation-filters"><a class="anchor" href="#rackspace-auth-user-saml-policy-translation-and-attribute-mapping-policy-validation-filters"></a>Rackspace Auth User, SAML Policy Translation, and Attribute Mapping Policy Validation Filters</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Consult with identity for where these filters now live.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="header-normalization-filter"><a class="anchor" href="#header-normalization-filter"></a>Header Normalization Filter</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>All matching targets will now be processed, previously only the first target that matched would be evaluated.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="url-extractor-to-header-filter"><a class="anchor" href="#url-extractor-to-header-filter"></a>URL Extractor to Header Filter</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>All capture groups in the URL regex will now add their captured values to the desired header.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you have configured a URL regex with multiple capture groups but do not desire the values of some of those groups to be added to the header, use the non-capturing group construct (i.e., <code>(?:X)</code>).
See <a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html#special">the special constructs portion of the Java Pattern documentation</a> for more information.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="openstack-identity-v3-filter"><a class="anchor" href="#openstack-identity-v3-filter"></a>OpenStack Identity v3 Filter</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Removed deprecated caching attributes:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>token-cache-timeout</code> on the <code>openstack-identity-v3</code> element; <code>token</code> on the <code>timeouts</code> element should be used instead.</p>
</li>
<li>
<p><code>groups-cache-timeout</code> on the <code>openstack-identity-v3</code> element; <code>group</code> on the <code>timeouts</code> element should be used instead.</p>
</li>
<li>
<p><code>cache-offset</code> on the <code>openstack-identity-v3</code> element; <code>variance</code> on the <code>timeouts</code> element should be used instead.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Cache timeouts are now defined in seconds rather than milliseconds.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>To convert existing timeouts, divide by <code>1000</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="keystone-v2-and-keystone-v2-authorization-filters"><a class="anchor" href="#keystone-v2-and-keystone-v2-authorization-filters"></a>Keystone v2 and Keystone v2 Authorization Filters</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>uri-tenant-quality</code> attribute was removed; the <code>validated-tenant-quality</code> should be used in its place.</p>
</li>
<li>
<p>Support for extracting required tenant ID(s) from the URI was removed from the <a href="../filters/keystone-v2-authorization.html">Keystone v2 Authorization Filter</a> and <a href="../filters/keystone-v2.html">Keystone v2 Filter</a> configuration.
To continue validating tenant ID(s) from the URI, follow these steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add the <a href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a> to your <a href="../architecture/filter-chain.html">Filter Chain</a> in the <a href="../architecture/system-model.html">System Model</a>.</p>
</li>
<li>
<p>Configure the <a href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a> to extract tenant ID(s) to a new header.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>For example, if your <a href="../filters/keystone-v2-authorization.html">Keystone v2 Authorization Filter</a> or <a href="../filters/keystone-v2.html">Keystone v2 Filter</a> was configured with:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;uri-extraction-regex&gt;</span>.*/servers/([:\-\w]+)/?.*<span style="color:#070;font-weight:bold">&lt;/uri-extraction-regex&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you would configure the <a href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a> with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;extraction</span> <span style="color:#b48">url-regex</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">.*/servers/([:-\w]+)/?.*</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">header</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">X-Expected-Tenant</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Replace usage of the <code>uri-extraction-regex</code> element with the <code>header-extraction-name</code> element in your <a href="../filters/keystone-v2-authorization.html">Keystone v2 Authorization Filter</a> and <a href="../filters/keystone-v2.html">Keystone v2 Filter</a> configuration.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The value of the <code>header-extraction-name</code> element should match the value of the header name configured in the <a href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a>.</p>
</li>
<li>
<p>Following the previous example, the configured header name would be <code>X-Expected-Tenant</code>.
Therefore, the <a href="../filters/keystone-v2-authorization.html">Keystone v2 Authorization Filter</a> or <a href="../filters/keystone-v2.html">Keystone v2 Filter</a> configuration should contain:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;header-extraction-name&gt;</span>X-Expected-Tenant<span style="color:#070;font-weight:bold">&lt;/header-extraction-name&gt;</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>If desired, follow best practice guidelines by adding the configured header name to the <a href="../filters/header-normalization.html">Header Normalization Filter</a> blacklist.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Following the previous examples, the configured header name would be <code>X-Expected-Tenant</code>.
Therefore, the <a href="../filters/header-normalization.html">Header Normalization Filter</a> configuration should contain something like:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;blacklist&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;header</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">X-Expected-Tenant</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/blacklist&gt;</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="for-integrators"><a class="anchor" href="#for-integrators"></a>For Integrators</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="core"><a class="anchor" href="#core"></a>Core</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>ServiceClient</code> utility has been removed.
The <a href="../services/http-client.html">HTTP Client Service</a> clients should be used instead.</p>
</li>
<li>
<p>The <code>HttpComponentFactory</code> utility has been removed.
Apache&#8217;s HTTP client <code>RequestBuilder</code> should be used instead.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="http-clientconnection-pool-service-2"><a class="anchor" href="#http-clientconnection-pool-service-2"></a>HTTP Client/Connection Pool Service</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The following methods have been removed from the HTTP Client Service API and should no longer be used:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>releaseClient</code></p>
</li>
<li>
<p><code>isAvailable</code></p>
</li>
<li>
<p><code>getAvailableClients</code></p>
</li>
<li>
<p><code>shutdown</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="akka-http-client-service"><a class="anchor" href="#akka-http-client-service"></a>Akka HTTP Client Service</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This service has been removed.
Functionality has been migrated to the <a href="../services/http-client.html">HTTP Client Service</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="request-proxy-service"><a class="anchor" href="#request-proxy-service"></a>Request Proxy Service</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The following methods have been removed from the Request Proxy Service API and should no longer be used:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>setRewriteHostHeader</code></p>
</li>
<li>
<p><code>proxyRequest(String, HttpServletRequest, HttpServletResponse, String)</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="reporting-service"><a class="anchor" href="#reporting-service"></a>Reporting Service</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This service has been removed.
Functionality has been migrated to publish to the the <a href="../services/metrics.html">Metrics Service</a>.</p>
</li>
<li>
<p>The <code>incrementRequestCount</code> an <code>getTotalStatusCode</code> methods can be retireved and manipulated using the following <code>Meters</code> and <code>Timers</code>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>org.openrepose.core.ResponseCode.Repose.&lt;statusCode&gt;</code></p>
</li>
<li>
<p><code>org.openrepose.core.ResponseCode.&lt;location&gt;.&lt;statusCodeClass&gt;</code></p>
</li>
<li>
<p><code>org.openrepose.core.ResponseTime.Repose.&lt;statusCode&gt;</code></p>
</li>
<li>
<p><code>org.openrepose.core.ResponseTime.&lt;location&gt;.&lt;statusCodeClass&gt;</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="/_javascripts/include-html.js" type="text/javascript"></script>
  <script>includeHTML();</script>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>